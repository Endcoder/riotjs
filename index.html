<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Riotjs : " />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Riotjs</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/Endcoder/riotjs">View on GitHub</a>

          <h1 id="project_title">Riotjs</h1>
          <h2 id="project_tagline"></h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/Endcoder/riotjs/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/Endcoder/riotjs/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="tutorial-riotjs" class="anchor" href="#tutorial-riotjs"><span class="octicon octicon-link"></span></a>Tutorial: RIOT.JS</h1>

<h2>
<a name="einleitung" class="anchor" href="#einleitung"><span class="octicon octicon-link"></span></a>Einleitung</h2>

<p>RIOT.JS ist eine Javascript Bibliothek, die es ermöglicht Webanwendungen
nach dem Model-View-Presenter Konzept (kurz: MVP) zu entwickeln. Dies
erlaubt es große Anwendungen modular aufzubauen, und so die Übersichtlichkeit
zu bewahren.</p>

<p>RIOT.JS zeichnet sich vor allem durch seine Größe aus, denn der minimierte
Quelltext ist lediglich 1.6kb groß. Die folgende Übersicht zeigt, wie klein
diese Bibliothek im Vergleich zu anderen wirklich ist:</p>

<p><img src="https://muut.com/m/img/riotjs/riot-size-1.6kb.png"></p>

<p>Des Weiteren basiert RIOT.JS auf Vanilla Javascript, also purem
Javascript, wodurch eine Abhängigkeit zu anderen Frameworks ausgeschlossen wird.</p>

<p>Bestandteil von RIOT.JS ist eine Template Engine, die es erlaubt HTML Templates
zu bauen und zu rendern, eine Event Libraray, die die Kommunikation und Callbacks
ermöglicht, und eine Routerfunktion, um die Navigation zu ermöglichen.</p>

<h2>
<a name="mvp" class="anchor" href="#mvp"><span class="octicon octicon-link"></span></a>MVP</h2>

<p>Das MVP-Pattern ist dem Model-View-Controller Pattern sehr ähnlich,
unterscheidet sich jedoch darin, dass es statt einem Controller einen Presenter
gibt. Im MVC Pattern konnten die einzelnen Komponen direkt miteinander interagieren,
im MVP Pattern ist dies nicht möglich.</p>

<p>Hier übernimmt der Presenter die Kommunikation zwischen View und Model in beide
Richtungen. Hieraus resultiert eine strikte Trennung von View und Model, wodurch
das Testen des Views mit Hilfe von Unit Tests ermöglicht wird.</p>

<ul>
<li>Model</li>
</ul><p>Das Model kennt weder den Presenter, noch den View und modelliert die Geschäftslogik.
D.h. hier ist die Struktur der Daten modelliert, und die grundlegende Logik implementiert.</p>

<ul>
<li>View</li>
</ul><p>Im View wird lediglich die Oberfläche dargestellt, und es ist lediglich für die Darstellung
der Ein- und Ausgaben zuständig. Die Steuerung des Views erfolgt ausschließlich
vom Presenter, in dem dieser auf Events des Views lauscht.</p>

<ul>
<li>Presenter</li>
</ul><p>Der Presenter ist das Bindeglied zwischen Model und View. Er übernimmt die gesamte Steuerung,
also sowohl der Oberfläche, als auch der Logik, und sorgt für Kommunikation zwischen Model
und View. </p>

<h2>
<a name="methoden" class="anchor" href="#methoden"><span class="octicon octicon-link"></span></a>Methoden</h2>

<p>Um Webanwendungen nach dem MVP Pattern mit Hilfe von Riot.JS zu entwickeln, werden
lediglich wenige Methoden benötigt. Hier zu zählen:</p>

<ul>
<li>riot.observable(element)</li>
</ul><p>Die Observable Methode erlaubt es dem gewählten Objekt die Event-basierte Kommunikation
zu nutzen, d.h. es können Events gefeuert und auf diese gelauscht werden.</p>

<div class="highlight highlight-Javascript"><pre><span class="kd">function</span> <span class="nx">Car</span><span class="p">()</span> <span class="p">{</span>

  <span class="c1">// Make Car instances observable</span>
  <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">observable</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

  <span class="c1">// listen to "start" event</span>
  <span class="nx">self</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"start"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// engine started</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="c1">// make a new Car instance</span>
<span class="kd">var</span> <span class="nx">car</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Car</span><span class="p">();</span>

<span class="c1">// trigger "start" event</span>
<span class="nx">car</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">"start"</span><span class="p">)</span>
</pre></div>

<ul>
<li>riot.trigger(event[, arguments])</li>
</ul><p>Die Trigger Methode erlaubt es einem Objekt Events zu feuern. Hierdurch
kann die Kommunikation zwischen Model und Presenter realisiert werden.</p>

<div class="highlight highlight-Javascript"><pre><span class="nx">el</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">"start"</span><span class="p">);</span>
</pre></div>

<ul>
<li>riot.on(event, callback)</li>
</ul><p>Die On-Methode bindet eine Funktion an ein Event, um so den Callback zu ermöglichen.
D.h. wenn beispielsweise das Model ein Event feuert, kann der Presenter mit Hilfe
der On-Methode auf dieses reagieren.</p>

<div class="highlight highlight-Javascript"><pre><span class="c1">// listen to single event</span>
<span class="nx">el</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"start"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

<span class="p">});</span>

<span class="c1">// listen to multiple events, the event type is given as the argument</span>
<span class="nx">el</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"start stop"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>

  <span class="c1">// type is either "start" or "stop"</span>

<span class="p">});</span>
</pre></div>

<ul>
<li>riot.render(template, data)</li>
</ul><p>Die Render Methode nutzt ein vorgebenen HTML-Template, um dieses mit Hilfe der gegebenen
Daten zu rendern. Somit werden Platzhalter in dem Template durch die gewünschten Daten
ersetzt und auf der Oberfläche dargestellt.</p>

<div class="highlight highlight-JavaScript"><pre><span class="c1">// returns: "&lt;h1&gt;Hello Testuser&lt;/h1&gt;"</span>
<span class="nx">riot</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">"&lt;h1&gt;Hello {username}&lt;/h1&gt;"</span><span class="p">,</span> <span class="p">{</span> <span class="nx">username</span><span class="o">:</span> <span class="s1">'Testuser'</span> <span class="p">});</span>

</pre></div>

<h2>
<a name="beispiel-todo-liste" class="anchor" href="#beispiel-todo-liste"><span class="octicon octicon-link"></span></a>Beispiel: TODO Liste</h2>

<p>Unter <a href="http://www.3den.org/riotjs-todomvc/">diesem Link</a> ist eine Beispielanwendung
zu finden, die eine TODO-Liste mit Hilfe von RIOT.JS zeigt.</p>

<p>Im folgenden soll mit Hilfe von relevanten Quelltextausschnitten die Funktionsweise erläutert werden.
Dies geschieht am Beispiel des Hinzufügens einer neuen Aufgabe.</p>

<p>Zunächst wird im View ein neues Template definiert, welches den Aufbau und das Aussehen eines neuen Eintrages
definiert:</p>

<div class="highlight highlight-HTML"><pre><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"task-template"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;li</span> <span class="na">id=</span><span class="s">"task_{id}"</span> <span class="na">data-task=</span><span class="s">"{id}"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"view todo-task"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">"toggle"</span> <span class="na">type=</span><span class="s">"checkbox"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;label&gt;</span>{name}<span class="nt">&lt;/label&gt;</span>
          <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"destroy"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">"edit"</span> <span class="na">value=</span><span class="s">"{name}"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/template&gt;</span>
</pre></div>

<p>Anschließend wird im Model ein Objekt erzeugt, welches der Observermethode übergeben wird, um 
das Nutzen von Events zu ermöglichen. Für das Persistieren der Aufgaben wird der Local Storage
des Browsers genutzt, welcher in diesem Fall über das "DB"-Objekt erreichbar ist.</p>

<div class="highlight highlight-JavaScript"><pre><span class="kd">function</span> <span class="nx">Todo</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">observable</span><span class="p">(</span><span class="k">this</span><span class="p">),</span>
        <span class="nx">db</span> <span class="o">=</span> <span class="nx">DB</span><span class="p">(</span><span class="s1">'riot-todo'</span><span class="p">),</span>
        <span class="nx">items</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">get</span><span class="p">();</span>

    <span class="nx">self</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="p">{</span>
          <span class="nx">id</span><span class="o">:</span> <span class="nx">generateId</span><span class="p">(),</span> <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">done</span><span class="o">:</span> <span class="nx">done</span>
        <span class="p">};</span>

        <span class="nx">items</span><span class="p">[</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="nx">item</span><span class="p">;</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">'add'</span><span class="p">,</span> <span class="nx">item</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="c1">// sync database</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'add remove toggle edit'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">db</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="nx">items</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="c1">//  hier können weitere Funktionen definiert werden</span>
<span class="p">}</span>
</pre></div>

<p>Die Add-Methode generiert ein neues Objekt mit der übergebenen
Aufgabe, und generiert eine eindeutige ID. Anschließend wird
das "Add" Event getriggert und gleichzeitig das erzeugte Objekt
übergeben.
Durch die on-Methode wird auf dieses Event gelauscht und der Eintrag persistiert.</p>

<p>Im folgenden wird der Presenter definiert. Dieser muss zum einen darauf lauschen,
ob in dem Eingabefeld die Entertaste gedrückt wurde, um in diesem Fall die Eingaben
an das Model weiterzuleiten.
Ist dies erledigt, muss der Presenter auf das "add"-Event des Models reagieren
und das Objekt nach Vorgabe des Templates rendern:</p>

<div class="highlight highlight-JavaScript"><pre><span class="kd">function</span> <span class="nx">todoPresenter</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">element</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">template</span><span class="p">,</span>
        <span class="nx">todo</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">model</span><span class="p">,</span>
        <span class="nx">$list</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'#todo-list'</span><span class="p">),</span>
        <span class="nx">ENTER_KEY</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
        <span class="nx">ESC_KEY</span> <span class="o">=</span> <span class="mi">27</span><span class="p">;</span>

    <span class="cm">/* Listen to user events */</span>

    <span class="nx">element</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'keyup'</span><span class="p">,</span> <span class="s1">'#new-todo'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// wenn Taste in Eingabefeld gedrückt</span>
        <span class="kd">var</span> <span class="nx">val</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">val</span> <span class="o">&amp;&amp;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">which</span> <span class="o">===</span> <span class="mi">13</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// wenn Enter-Taste gedrückt</span>
            <span class="nx">todo</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>            <span class="c1">// rufe Model auf, um Objekt anzulegen</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>          <span class="c1">// leere Eingabefeld</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="cm">/* Listen to model events */</span>

    <span class="nx">todo</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'add'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">){</span>
        <span class="nx">$</span><span class="p">(</span><span class="s2">"#main"</span><span class="p">,</span> <span class="nx">element</span><span class="p">).</span><span class="nx">show</span><span class="p">();</span>
        <span class="kd">var</span> <span class="nx">task</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">template</span><span class="p">,</span> <span class="nx">item</span><span class="p">));</span>
        <span class="nx">$list</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">task</span><span class="p">);</span>
        <span class="nx">toggle</span><span class="p">(</span><span class="nx">task</span><span class="p">,</span> <span class="o">!!</span><span class="nx">item</span><span class="p">.</span><span class="nx">done</span><span class="p">);</span>
    <span class="p">});</span>
</pre></div>

<p>Zuletzt müssen die einzelnen Komponenten initialisiert werden:</p>

<div class="highlight highlight-JavaScript"><pre><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">todo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Todo</span><span class="p">();</span>
    <span class="nx">routes</span><span class="p">({</span><span class="nx">todo</span><span class="o">:</span> <span class="nx">todo</span><span class="p">});</span>

    <span class="c1">// Binds the Todo Presenter</span>
    <span class="nx">todoPresenter</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">"#todoapp"</span><span class="p">),</span> <span class="p">{</span>
        <span class="nx">model</span><span class="o">:</span> <span class="nx">todo</span><span class="p">,</span>
        <span class="nx">template</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#task-template'</span><span class="p">).</span><span class="nx">html</span><span class="p">(),</span>
    <span class="p">});</span>

    <span class="c1">// Binds the Footer Presenter</span>
    <span class="nx">footerPresenter</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">"#footer"</span><span class="p">),</span> <span class="p">{</span>
        <span class="nx">model</span><span class="o">:</span> <span class="nx">todo</span><span class="p">,</span>
        <span class="nx">template</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#footer-template'</span><span class="p">).</span><span class="nx">html</span><span class="p">(),</span>
    <span class="p">});</span>
<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>
</pre></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Riotjs maintained by <a href="https://github.com/Endcoder">Endcoder</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
